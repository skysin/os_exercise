# lec4

## 启动顺序

* 代码段寄存器CS：存放当前正在运行的程序代码所在段的段基址，表示当前使用的指令代码可以从该段寄存器指定的存储器段中取得，  相应的偏移量则由IP提供。
  数据段寄存器DS：指出当前程序使用的数据所存放段的最低地址，即存放数据段的段基址。
  堆栈段寄存器SS：指出当前堆栈的底部地址，即存放堆栈段的段基址。
  附加段寄存器ES：指出当前程序使用附加数据段的段基址，该段是串操作指令中目的串所在的段。

* CPL是当前进程的权限级别,是当前正在执行的代码所在的段的特权级，存在于cs寄存器的低两位。
  RPL说明的是进程对段访问的请求权限(Request Privilege Level)，是对于段选择子而言的，每个段选择子有自己的RPL，它说明的是进程对段访问的请求权限.
  DPL存储在段描述符中，规定访问该段的权限级别(Descriptor Privilege Level)，每个段的DPL固定。当进程访问一个段时，需要进程特权级检查，一般要求DPL >= max {CPL, RPL}

## x86中断处理过程

* 硬件把eflags、cs、eip、错误码err code依次压栈。用户态中断涉及特权级的切换，需要额外将ss和esp寄存器压栈，而内核态中断不需要。

* 因为用户可能修改内核程序，造成安全问题。

* trap是陷阱，interrupt是中断。后者的优先级更高。如果不做区分，可能出现中断无法打断陷阱的情况。

## 4.8

* 因为read_ebp是内核态，需要不被调用直接使用，而read_eip是用户态。

## 4.9

* 不是使能的，因为未设置中断表。