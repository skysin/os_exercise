# lec6

## 6.1

* 提高分配的灵活性。提高内存的利用效率：方便共享、充分利用内存空间

* 大块好管理，小块更灵活

* 固定大小好管理，多种大小比一种大小灵活。可变大小更灵活，通常可变大小也会通过对齐来减少管理难度

## 6.2

* 段表示访问方式和存储数据等属性相同的一段地址空间。段基址表示该地址空间的开始地址，段内偏移则是段内的地址与段基址的偏移量

* 段式存储管理中，地址转换是段基址（段号）加段内偏移。段反映了程序的存储逻辑结构，程序不会从一个段的基址去访问另一个段，于是不同的段可以不连续。好处是可以不连续，方便内存管理；麻烦是地址转换稍微复杂了一些。

## 6.3

* > 页是程序的逻辑地址空间被划分成的固定大小的块
  >
  > 帧是物理地址空间被划分成的固定大小的块
  >
  > 页表是一种特殊的数据结构，放在系统空间的页表区，存放逻辑页与物理页帧的对应关系。
  >
  > 存储器管理单元（MMU），用于是实现虚拟内存和内存的分区保护
  >
  > TLB是一个内存管理单元用于改进虚拟地址到物理地址转换速度的缓存.
  >
  > cache是为了解决处理器与慢速DRAM设备之间巨大的速度差异而出现的。cache属于硬件系统。

* 页式存储管理中，地址转换是页号加页内偏移。CPU使用连续的逻辑地址，存储访问时，逻辑地址先分成逻辑页号和页内偏移，然后通过页表定义的对应关系，把逻辑页面转换成物理页号，最后再把物理页号加页内偏移得到物理地址；于是不同的段可以不连续。好处是可以不连续，方便内存管理中的存储分配和回收；麻烦是地址转换比较复杂（页表项访问开销和页表存储开销），并且频繁进行（每次存储访问会变成两次或更多）。

## 6.4

* 页表项有虚拟页号，对应的物理页号以及一系列标志位。标志位有有效位，访问位，修改位，权限位。有效位用来指示对应页是否缓存在内存中，访问位和修改位可以作为页面置换算法选择换出页面的依据，权限位则对存储给予了保护，避免进程越权访问。

* 页大小、地址空间大小、进程数目

## 6.5

* 快表是对页表的缓存，而高速缓存是对进程运行的内存进行缓存。

* 因为块表的硬件是基于SRAM的cache，存储介质访问速度更快。快表通过将最近访问到的一部分页表内容从主存中加载到cache中，使得在需要访问这些已经被缓存的页表项时不需要访问主存而可以直接在cache中获得需要的页表项。快表的容量限制主要是来自于对功耗和价格的考虑。

* 多级页表是对一级列表进一步分块索引存储，形成更多层次的物理地址查询结构。多级页表的地址转换首先根据虚拟地址的较高位页索引在高级页表查找到对应下一级页表的物理地址，再到下一级页表中依据虚拟地址中的索引查找，直到确定最终的物理页的物理地址。多级页表减少了存储页表所需要的存储空间，但是增加了地址转换的复杂度。

## 6.6

* 页寄存器的内容，逻辑地址进行hash，然后查相应页寄存器

* 反置页表项的内容，逻辑地址和进程号共同进行hash，然后查相应页寄存器

* PID、逻辑页号、标志位

## 6.7

* 对于给出的逻辑地址，根据段寄存器中的内容选择到GDT或LDT中对应的段表中查询虚拟地址所对应的段的基址。查询过程中需要进行地址是否越界的检查。根据段基址和逻辑地址中的段内偏移对段进行访问。这种做法增强了对内存的保护，防止越权访问以及进程对不属于自身的存储空间访问。麻烦是增加了地址转换的复杂度。

* 可以通过对代码的动态链接，实现多道程序以段为单位共享同一代码库。

* 可以将不同的虚拟地址映射到同一物理地址，采用换出的方式来实现内存的共享。
