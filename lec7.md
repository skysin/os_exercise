# lec7

## 7.1

* 4个

* 区别：特权指令只能在ring 0使用；一条指令在不同特权下能访问的数据范围是不一样的；一条指令在不同特权级下的行为是不一样的。

* CPL：当前进程优先级；DPL：数据段需求的优先级；RPL：进程当前请求的优先级；访问门时：从低优先级代码访问高优先级服务；访问段时：从高优先级代码访问低优先级数据。

## 7.2

* 执行特权指令是是否在内核态；访问的数据段是否符合特权级要求；中断等特殊指令在什么特权级下执行。

* 系统调用、中断(int,iret)；

* 在ring3下会额外压栈ss与esp并进行堆栈切换。

* 在iret前修改堆栈，让其变成对应特权级进入中断时的形式。

* 保存ring0-2的段工作信息、页表信息等内容。

## 7.3

* (1+页表级数)次

* 先通过段选择符确定段基址，再通过多级页偏移决定物理帧，最后加上偏移得到实际物理地址。

## 7.4

* 设置各段基址；将cr0的保护模式位打开，进入保护模式，开启MMU。

* 将一页内存分配为页表；映射0xc0000000以上地址；映射0-0x01000000地址；设置cr3及cr0第31位；取消0-0x01000000地址的映射。

## 个人思考题

* 内存寻址过程中；代码跳转过程中；中断处理过程中

* 初始化GDT，完成段机制；探测物理内存，将空闲物理内存组织成页；建立页表，设置cr3与cr0寄存器。